SELECT v.CUSTOMER_ID, COUNT(v.VISIT_ID) AS COUNT_NO_TRANS
FROM VISITS v
LEFT JOIN TRANSACTIONS t ON t.VISIT_ID = v.VISIT_ID
WHERE t.TRANSACTION_ID IS NULL
GROUP BY v.CUSTOMER_ID;
